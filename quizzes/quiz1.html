<script>
  const quiz = {
    module_title: "Introduction to Information Security",
    questions: [
      {
        question: "What is the primary goal of information security?",
        options: [
          "To prevent all employees from accessing sensitive data",
          "To protect confidentiality, integrity, and availability of information",
          "To install antivirus software on all computers",
          "To encrypt all company emails"
        ],
        correctAnswer: 1,
        feedback: "‚úîÔ∏è Correct! InfoSec ensures confidentiality, integrity, and availability."
      },
      {
        question: "Which of the following is NOT part of the CIA triad?",
        options: [
          "Confidentiality",
          "Integrity",
          "Authentication",
          "Availability"
        ],
        correctAnswer: 2,
        feedback: "üîí Authentication is important but not part of the CIA triad."
      },
      {
        question: "Why is InfoSec important for organizations?",
        options: [
          "Only needed by governments",
          "Only financial institutions need it",
          "It prevents loss, reputation harm, and penalties",
          "Only companies with 1000+ employees"
        ],
        correctAnswer: 2,
        feedback: "‚úÖ Protecting against loss and penalties is key!"
      },
      {
        question: "Who is responsible for information security?",
        options: [
          "Only IT",
          "Only CISO",
          "Only senior leadership",
          "Every employee"
        ],
        correctAnswer: 3,
        feedback: "üôå Security is everyone‚Äôs responsibility."
      },
      {
        question: "What is 'defense in depth'?",
        options: [
          "Strongest firewall possible",
          "Multiple security layers",
          "Focus all efforts on critical systems",
          "Only IT training"
        ],
        correctAnswer: 1,
        feedback: "üõ°Ô∏è Defense in depth = layered protection."
      }
    ]
  };

  let currentQuestion = 0;
  const maxAttempts = 3;
  const attempts = Array(quiz.questions.length).fill(0);
  const userAnswers = Array(quiz.questions.length).fill(null);
  const isAnswered = Array(quiz.questions.length).fill(false);

  const quizBox = document.getElementById("quiz-box");
  const feedback = document.getElementById("feedback");
  const prevBtn = document.getElementById("prevBtn");
  const nextBtn = document.getElementById("nextBtn");
  const progress = document.getElementById("progress");

  function renderQuestion() {
    const q = quiz.questions[currentQuestion];
    document.getElementById("quiz-title").textContent = `Quiz: ${quiz.module_title}`;
    feedback.classList.add("hidden");

    quizBox.innerHTML = `
      <h3 class="text-md font-semibold mb-2">${q.question}</h3>
      <ul class="space-y-2">
        ${q.options.map((opt, i) => `
          <li>
            <label class="flex items-center space-x-2">
              <input type="radio" name="option" value="${i}" class="form-radio text-blue-600">
              <span class="text-sm">${opt}</span>
            </label>
          </li>
        `).join('')}
      </ul>
    `;

    progress.textContent = `Question ${currentQuestion + 1} of ${quiz.questions.length}`;
    prevBtn.disabled = currentQuestion === 0;
    nextBtn.disabled = !isAnswered[currentQuestion];

    prevBtn.style.display = "inline-block";
    nextBtn.style.display = "inline-block";
    nextBtn.textContent = currentQuestion === quiz.questions.length - 1 ? "Finish" : "Next";
  }

  function showFeedback(selectedIndex) {
    const q = quiz.questions[currentQuestion];
    const isCorrect = selectedIndex === q.correctAnswer;
    attempts[currentQuestion]++;

    if (isCorrect) {
      feedback.textContent = q.feedback;
      feedback.className = `mt-4 text-sm font-medium text-green-600`;
      userAnswers[currentQuestion] = selectedIndex;
      isAnswered[currentQuestion] = true;
    } else if (attempts[currentQuestion] >= maxAttempts) {
      feedback.textContent = `‚ùå Incorrect. ${q.feedback}`;
      feedback.className = `mt-4 text-sm font-medium text-red-600`;
      userAnswers[currentQuestion] = selectedIndex;
      isAnswered[currentQuestion] = true;
    } else {
      const triesLeft = maxAttempts - attempts[currentQuestion];
      feedback.textContent = `‚ùå Incorrect. Try again (${triesLeft} attempt${triesLeft > 1 ? 's' : ''} left).`;
      feedback.className = `mt-4 text-sm font-medium text-red-600`;
    }

    feedback.classList.remove("hidden");
    nextBtn.disabled = !isAnswered[currentQuestion];
  }

  quizBox.addEventListener("change", () => {
    const selected = document.querySelector('input[name="option"]:checked');
    if (selected) {
      showFeedback(parseInt(selected.value));
    }
  });

  nextBtn.addEventListener("click", () => {
    if (currentQuestion < quiz.questions.length - 1) {
      currentQuestion++;
      renderQuestion();
    } else {
      // Quiz completed
      const score = userAnswers.filter((a, i) => a === quiz.questions[i].correctAnswer).length;
      quizBox.innerHTML = `
        <h3 class="text-lg font-bold mb-2">üéâ Quiz Completed!</h3>
        <p class="text-sm mb-4">You got <strong>${score}</strong> out of <strong>${quiz.questions.length}</strong> correct.</p>
        <a href="../novo-index.html" class="inline-block bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 transition text-sm">Back to Home</a>
      `;
      feedback.classList.add("hidden");
      prevBtn.style.display = "none";
      nextBtn.style.display = "none";
      progress.textContent = '';
    }
  });

  prevBtn.addEventListener("click", () => {
    if (currentQuestion > 0) {
      currentQuestion--;
      renderQuestion();
    }
  });

  renderQuestion();
</script>


