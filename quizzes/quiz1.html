<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Quiz 1: Introduction to Information Security</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-50 text-gray-800 min-h-screen flex flex-col">

  <!-- Top Bar -->
  <div class="w-full bg-gray-200 py-2 px-4">
    <a href="../modules/module1.html" class="inline-flex items-center text-gray-700 hover:text-gray-900 font-medium">
      <svg class="h-4 w-4 mr-2 text-gray-700" fill="currentColor" viewBox="0 0 20 20">
        <path fill-rule="evenodd" d="M10 18a1 1 0 01-.7-.3l-6-6a1 1 0 010-1.4l6-6a1 1 0 011.4 1.4L5.42 10l5.3 5.3A1 1 0 0110 18z" clip-rule="evenodd" />
      </svg>
      Back to Module
    </a>
  </div>

  <!-- Quiz Content -->
  <div class="flex-1 flex items-center justify-center p-6">
    <div class="w-full max-w-2xl bg-white p-6 rounded shadow-md space-y-4">
      <h2 id="quiz-title" class="text-lg font-semibold"></h2>
      <div id="progress" class="text-sm text-gray-500"></div>
      <div id="quiz-box" class="space-y-4"></div>
      <div id="feedback" class="text-sm font-medium"></div>
      <div class="flex justify-between pt-4">
        <button id="prevBtn" class="bg-gray-600 text-white px-4 py-2 rounded hover:bg-gray-700 transition">Previous</button>
        <button id="nextBtn" class="bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 transition">Next</button>
      </div>
    </div>
  </div>

  <script>
    let currentQuestion = 0;
    let attemptsLeft = 3;
    let score = 0;
    let quizData = [];

    const quizTitleEl = document.getElementById("quiz-title");
    const quizBox = document.getElementById("quiz-box");
    const feedbackEl = document.getElementById("feedback");
    const progressEl = document.getElementById("progress");
    const prevBtn = document.getElementById("prevBtn");
    const nextBtn = document.getElementById("nextBtn");

    fetch("quiz1.json")
      .then(res => res.json())
      .then(data => {
        quizData = data.questions;
        quizTitleEl.textContent = `Quiz: ${data.module_title}`;
        renderQuestion();
      });

    function renderQuestion() {
      const q = quizData[currentQuestion];
      attemptsLeft = 3;
      feedbackEl.textContent = "";
      quizBox.innerHTML = `
        <p class="font-medium">${q.question}</p>
        <ul class="space-y-2">
          ${q.options.map((opt, i) => `
            <li>
              <button class="w-full text-left border rounded p-2 hover:bg-gray-100 option-btn" data-index="${i}">
                ${opt}
              </button>
            </li>`).join("")}
        </ul>
      `;
      updateProgress();
      updateButtons();
      document.querySelectorAll(".option-btn").forEach(btn =>
        btn.addEventListener("click", handleAnswer));
    }

    function handleAnswer(e) {
      const selected = parseInt(e.target.dataset.index);
      const correct = quizData[currentQuestion].correctAnswer;
      if (selected === correct) {
        e.target.classList.add("bg-green-100", "border-green-400");
        feedbackEl.textContent = "✅ Correct!";
        score++;
        disableOptions();
      } else {
        attemptsLeft--;
        e.target.classList.add("bg-red-100", "border-red-400");
        feedbackEl.textContent = `❌ Wrong! ${attemptsLeft > 0 ? `Attempts left: ${attemptsLeft}` : quizData[currentQuestion].feedback}`;
        if (attemptsLeft <= 0) disableOptions();
      }
    }

    function disableOptions() {
      document.querySelectorAll(".option-btn").forEach(btn => {
        btn.disabled = true;
      });
    }

    function updateProgress() {
      progressEl.textContent = `Question ${currentQuestion + 1} of ${quizData.length}`;
    }

    function updateButtons() {
      prevBtn.disabled = currentQuestion === 0;
      nextBtn.disabled = currentQuestion === quizData.length - 1;
    }

    prevBtn.addEventListener("click", () => {
      if (currentQuestion > 0) {
        currentQuestion--;
        renderQuestion();
      }
    });

    nextBtn.addEventListener("click", () => {
      if (currentQuestion < quizData.length - 1) {
        currentQuestion++;
        renderQuestion();
      } else {
        quizBox.innerHTML = `<p class="text-lg font-semibold">✅ Quiz Completed!</p>
        <p class="text-sm">You answered ${score} out of ${quizData.length} correctly.</p>`;
        feedbackEl.textContent = "";
        progressEl.textContent = "";
        prevBtn.style.display = "none";
        nextBtn.style.display = "none";
      }
    });
  </script>
</body>
</html>
